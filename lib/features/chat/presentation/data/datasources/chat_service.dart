class ChatService {
  // κ°„λ‹¨ν• QnA λ°μ΄ν„°λ² μ΄μ¤
  static final Map<String, String> _qnaDatabase = {
    // μΈμ‚¬
    'μ•λ…•': 'μ•λ…•ν•μ„Έμ” π μ™μ† μμ•½ κ΄€λ ¨ μ•λ‚΄λ¥Ό μ κ³µν•©λ‹λ‹¤.',
    'μ•λ…•ν•μ„Έμ”': 'λ°κ°‘μµλ‹λ‹¤! μ–΄λ””λ΅ μ—¬ν–‰ κ°€μ‹λ‚μ”? μ €λ” μ™μ† μμ•½ κ΄€λ ¨ μ•λ‚΄λ¥Ό μ κ³µν•κ³  μμ–΄μ”.',
    'hi': 'Hi! I can help you find a place to stay.',
    'hello': 'Hello π Looking for a hotel or accommodation?',

    // μ™μ† κ²€μƒ‰
    'μ™μ†': 'λ©”μΈ ν™”λ©΄μ—μ„ μ§€μ—­, λ‚ μ§, μΈμ›μ„ μ„ νƒν•΄ μ™μ†λ¥Ό κ²€μƒ‰ν•  μ μμ–΄μ”.',
    'νΈν…”': 'λ©”μΈ ν™”λ©΄ > μ™μ† κ²€μƒ‰ κ²°κ³Όμ—μ„ νΈν…” μ ν•μ„ μ„ νƒν•  μ μμ–΄μ”.',
    'μμ•½': 'μ™μ† μƒμ„Έ ν™”λ©΄ ν•λ‹¨μ [μμ•½ν•κΈ°] λ²„νΌμ„ ν†µν•΄ μμ•½ν•  μ μμ–΄μ”.',
    'κ²€μƒ‰': 'λ©”μΈ ν™”λ©΄ μƒλ‹¨ κ²€μƒ‰ μμ—­μ—μ„ μ™μ† κ²€μƒ‰μ΄ κ°€λ¥ν•΄μ”.',

    // μ²΄ν¬μΈ / μ²΄ν¬μ•„μ›ƒ
    'μ²΄ν¬μΈ': 'μ™μ† μƒμ„Έ ν™”λ©΄ > λ¨λ“  κ°μ‹¤ λ³΄κΈ°μ—μ„ μ²΄ν¬μΈ μ‹κ°„μ„ ν™•μΈν•  μ μμ–΄μ”.',
    'μ²΄ν¬μ•„μ›ƒ': 'μ™μ† μƒμ„Έ ν™”λ©΄ > λ¨λ“  κ°μ‹¤ λ³΄κΈ°μ—μ„ μ²΄ν¬μ•„μ›ƒ μ‹κ°„μ„ ν™•μΈν•  μ μμ–΄μ”.',
    'μ…μ‹¤': 'λ§μ΄νμ΄μ§€ > μμ•½λ‚΄μ—­ > μμ•½ μƒμ„Έμ—μ„ μ…μ‹¤ μ‹κ°„μ„ ν™•μΈν•  μ μμ–΄μ”.',
    'ν‡΄μ‹¤': 'λ§μ΄νμ΄μ§€ > μμ•½λ‚΄μ—­ > μμ•½ μƒμ„Έμ—μ„ ν‡΄μ‹¤ μ‹κ°„μ„ ν™•μΈν•  μ μμ–΄μ”.',

    // μ·¨μ† / ν™λ¶
    'μ·¨μ†': 'λ§μ΄νμ΄μ§€ > μμ•½λ‚΄μ—­ > μμ•½ μƒμ„Έμ—μ„ μ·¨μ† κ°€λ¥ μ—¬λ¶€λ¥Ό ν™•μΈν•  μ μμ–΄μ”.',
    'ν™λ¶': 'μμ•½ μƒμ„Έ ν™”λ©΄μ— ν‘μ‹λ ν™λ¶ μ •μ±…μ„ ν™•μΈν•΄μ£Όμ„Έμ”.',

    // κ²°μ 
    'κ²°μ ': 'μμ•½ κ³Όμ • μ¤‘ κ²°μ  ν™”λ©΄μ—μ„ κ²°μ  μλ‹¨μ„ μ„ νƒν•  μ μμ–΄μ”.',
    'μΉ΄λ“': 'κ²°μ  ν™”λ©΄μ—μ„ μ‹ μ©μΉ΄λ“λ¥Ό μ„ νƒν•  μ μμ–΄μ”.',
    'νμ΄': 'κ°„νΈκ²°μ λ” μ§€μ›ν•μ§€ μ•κ³  μμ–΄μ”.',

    // κ³ κ° μ§€μ›
    'λ¬Έμ': 'μ–΄λ–¤ μ μ΄ λ¶νΈν•μ‹ κ°€μ”? μμ„Έν λ§μ”€ν•΄ μ£Όμ„Έμ”.',
    'κ³ κ°μ„Όν„°': 'κ³ κ°μ„Όν„° μ—°κ²°μ„ λ„μ™€λ“λ¦΄κ²μ”.',
    'μƒλ‹΄': 'μƒλ‹΄μ΄ ν•„μ”ν•μ‹λ©΄ λ¬Έμ λ‚΄μ©μ„ λ‚¨κ²¨μ£Όμ„Έμ”.',

    // κΈ°νƒ€
    'κ³ λ§μ›': 'μ²λ§μ—μ” π μ¦κ±°μ΄ μ—¬ν–‰ λμ„Έμ”!',
    'κ°μ‚¬': 'λ„μ›€μ΄ λμ–΄ κΈ°λ»μ”!',
  };

  // ν‚¤μ›λ“ κΈ°λ° μ‘λ‹µ
  static final Map<String, String> _keywordResponses = {
    'μ§€μ—­': 'μ–΄λ μ§€μ—­μΌλ΅ μ—¬ν–‰μ„ κ³„νν•κ³  κ³„μ‹ κ°€μ”?',
    'λ‚ μ§': 'μ²΄ν¬μΈκ³Ό μ²΄ν¬μ•„μ›ƒ λ‚ μ§λ¥Ό μ•λ ¤μ£Όμ„Έμ”.',
    'μΈμ›': 'μ΄ λ‡ λ¶„μ΄μ„ μ΄μ©ν•μ‹¤ μμ •μΈκ°€μ”?',
    'κ°€κ²©': 'μμ‚° λ²”μ„κ°€ μλ‹¤λ©΄ μ•λ ¤μ£Όμ„Έμ”.',
    'μ¶”μ²': 'μ„ νΈν•μ‹λ” μ™μ† νƒ€μ…μ΄ μλ‚μ”? (νΈν…”, νμ… λ“±)',
    'λ¦¬λ·°': 'λ¦¬λ·° μ μκ°€ λ†’μ€ μ™μ†λ¶€ν„° μ•λ‚΄ν•΄λ“λ¦΄κ²μ”.',
    'μ£Όμ°¨': 'μ£Όμ°¨ κ°€λ¥ μ—¬λ¶€λ” μ™μ† μƒμ„Έ μ •λ³΄μ—μ„ ν™•μΈν•  μ μμ–΄μ”.',
    'μ΅°μ‹': 'μ΅°μ‹ μ κ³µ μ—¬λ¶€λ” μ™μ† μƒμ„Έ μ •λ³΄μ—μ„ ν™•μΈν•  μ μμ–΄μ”.',
  };

  static Future<String> AIsendMessage(
      String message,
      List<Map<String, String>> conversationHistory
      ) async {
    // λ©”μ‹μ§€λ¥Ό μ†λ¬Έμλ΅ λ³€ν™ν•κ³  κ³µλ°± μ κ±°
    final lowerMessage = message.toLowerCase().trim();

    // μ§§μ€ μ§€μ—°μΌλ΅ μ‹¤μ  μ±„ν…μ²λΌ λ³΄μ΄κ²
    await Future.delayed(const Duration(milliseconds: 500));

    // μ •ν™•ν• λ§¤μΉ­ ν™•μΈ
    for (var entry in _qnaDatabase.entries) {
      if (lowerMessage.contains(entry.key.toLowerCase())) {
        return entry.value;
      }
    }

    // ν‚¤μ›λ“ λ§¤μΉ­
    for (var entry in _keywordResponses.entries) {
      if (lowerMessage.contains(entry.key)) {
        return entry.value;
      }
    }

    // λ¬Όμν‘κ°€ μμΌλ©΄ μ§λ¬ΈμΌλ΅ κ°„μ£Ό
    if (message.contains('?') || message.contains('οΌ')) {
      return _getRandomQuestionResponse();
    }

    // κΈ°λ³Έ μ‘λ‹µ
    return _getRandomDefaultResponse();
  }

  static String _getRandomQuestionResponse() {
    final responses = [
      'μΆ‹μ€ μ§λ¬Έμ΄μ—μ” π μ§€μ—­, λ‚ μ§, μΈμ›μ„ μ•λ ¤μ£Όμ‹λ©΄ λ°”λ΅ λ„μ™€λ“λ¦΄κ²μ”.',
      'μ™μ† μμ•½κ³Ό κ΄€λ ¨λ μ§λ¬Έμ΄λΌλ©΄ μμ„Έν μ•λ‚΄ν•΄λ“λ¦΄ μ μμ–΄μ”.',
      'μ΅°κΈ λ” κµ¬μ²΄μ μΌλ΅ λ§μ”€ν•΄μ£Όμ‹λ©΄ μ •ν™•ν μ•λ‚΄ν• κ²μ”.',
    ];
    return responses[DateTime.now().millisecond % responses.length];
  }

  static String _getRandomDefaultResponse() {
    final responses = [
      'μ™μ†, μμ•½, μ²΄ν¬μΈ κ°™μ€ ν‚¤μ›λ“λ΅ μ§λ¬Έν•΄λ³΄μ„Έμ” π',
      'μ§€μ—­κ³Ό λ‚ μ§λ¥Ό μ•λ ¤μ£Όμ‹λ©΄ μ™μ†λ¥Ό μ°Ύμ•„λ“λ¦΄κ²μ”.',
      'μ–΄λ–¤ λ„μ›€μ΄ ν•„μ”ν•μ‹ κ°€μ”? μμ λ΅­κ² λ§μ”€ν•΄μ£Όμ„Έμ”.',
      'μ—¬ν–‰ κ³„ν μ¤‘μ΄μ‹ κ°€μ”? μ κ°€ λ„μ™€λ“λ¦΄κ²μ”!',
    ];
    return responses[DateTime.now().millisecond % responses.length];
  }
}
